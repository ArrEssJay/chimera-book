\section{Multipath Propagation \& Fading (Rayleigh \&
Rician)}\label{multipath-propagation-fading-rayleigh-rician}

{[}{[}Home{]}{]} \textbar{} \textbf{RF Propagation} \textbar{}
{[}{[}Channel-Models-(Rayleigh-\&-Rician){]}{]} \textbar{}
{[}{[}Atmospheric-Effects-(Ionospheric,-Tropospheric){]}{]}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ For Non-Technical
Readers}{ For Non-Technical Readers}}\label{for-non-technical-readers}

\textbf{Multipath is like hearing echoes in a canyon-\/-\/-radio signals
bounce off buildings/walls and arrive at your phone from multiple
directions at slightly different times.}

\textbf{The problem}: 1. Signal travels \textbf{direct path} from tower
to phone (fast) 2. Same signal bounces off buildings (slower paths) 3.
All copies arrive at different times and \textbf{interfere} with each
other 4. Sometimes they add up (strong signal), sometimes they cancel
out (weak signal) 5. This causes \textbf{fading}: signal strength
fluctuates wildly as you move!

\textbf{Real-world experience}: - \textbf{Driving through city}: Cell
signal goes from 5 bars to 2 bars back to 5
bars-\/-\/-that\textquotesingle s multipath fading - \textbf{WiFi dead
spots}: Walk 1 meter and signal drops-\/-\/-destructive interference
from multipath - \textbf{Crackling old TV}: Picture would fade
in/out-\/-\/-multipath from distant transmitter

\textbf{Two types}:

\textbf{1. Rayleigh fading} (no direct path): - All paths are
bounced/scattered - Signal strength varies randomly (can drop 30+ dB!) -
Common in dense urban areas, indoors

\textbf{2. Rician fading} (strong direct path + echoes): - One dominant
path (line-of-sight) + weaker echoes - Less severe fading - Common in
open areas, suburban

\textbf{How engineers fix it}: - \textbf{MIMO}: Multiple antennas sample
different fade patterns - \textbf{OFDM}: Spread data across many
frequencies-\/-\/-some fade, others don\textquotesingle t -
\textbf{Adaptive coding}: Slow down when fading is bad -
\textbf{Interleaving}: Spread bits over time so fades
don\textquotesingle t wipe out whole packets

\textbf{Fun fact}: Multipath is why 5G uses higher
frequencies-\/-\/-shorter waves = less bouncing = more predictable (but
shorter range!).

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Overview}\label{overview}

\textbf{Multipath propagation} occurs when RF signals reach the receiver
via \textbf{multiple paths} simultaneously, each with different: -
\textbf{Delay} (arrival time) - \textbf{Amplitude} (path loss) -
\textbf{Phase} (due to different path lengths)

\textbf{Result}: Signals combine \textbf{constructively} or
\textbf{destructively}, causing \textbf{fading} (rapid signal strength
variations).

\textbf{Critical for}: Cellular networks, WiFi, mobile satellite, any
NLOS (non-line-of-sight) communication

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Physical Mechanisms}\label{physical-mechanisms}

\subsubsection{Reflection}\label{reflection}

\textbf{EM waves bounce off surfaces}: - \textbf{Ground} (two-ray model)
- \textbf{Buildings} (urban canyons) - \textbf{Water} (maritime comms) -
\textbf{Ionosphere} (HF skywave)

\textbf{Reflection coefficient} depends on: - Polarization (horizontal
vs vertical) - Angle of incidence - Surface material (conductivity,
permittivity)

\textbf{Example}: Concrete wall at 2.4 GHz \$\textbackslash rightarrow\$
\textasciitilde0.3-0.5 reflection coefficient (\textasciitilde3-6 dB
loss per bounce)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Diffraction}\label{diffraction}

\textbf{Bending around obstacles} (Fresnel diffraction): - Building
edges - Hills/terrain - Trees

\textbf{Knife-edge diffraction loss}:

\[
L_d \approx 6 + 20\log\left(\sqrt{(v-0.1)^2 + 1} + v - 0.1\right) \quad (\text{dB})
\]

Where \(v\) = Fresnel-Kirchhoff diffraction parameter

\textbf{Implication}: Signals can ``bend'' into shadowed regions (NLOS
coverage possible)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Scattering}\label{scattering}

\textbf{Interaction with rough surfaces or small objects}: - Rough
terrain (vegetation, rocks) - Lamp posts, signs - Rain/fog droplets (at
high frequencies)

\textbf{Rayleigh scattering} (object size \$\textbackslash ll\$
\$\textbackslash lambda\$):

\[
P_{\text{scattered}} \propto \frac{1}{\lambda^4}
\]

\textbf{Example}: Blue sky (visible light Rayleigh scattering from air
molecules)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Time-Domain Effects}\label{time-domain-effects}

\subsubsection{Delay Spread}\label{delay-spread}

\textbf{Multipath components arrive at different times}:

\[
\tau_{\text{rms}} = \sqrt{\frac{\sum P_i (\tau_i - \bar{\tau})^2}{\sum P_i}}
\]

Where: - \(P_i\) = Power of path \(i\) - \(\tau_i\) = Delay of path
\(i\) - \(\bar{\tau}\) = Mean delay

\textbf{Typical values}: - \textbf{Rural/suburban}: 0.1-1
\$\textbackslash mu\$s - \textbf{Urban}: 1-5 \$\textbackslash mu\$s -
\textbf{Indoor}: 10-100 ns

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Coherence Bandwidth}\label{coherence-bandwidth}

\textbf{Frequency range over which channel response is flat}:

\[
B_c \approx \frac{1}{5\tau_{\text{rms}}}
\]

\textbf{Implication}: If signal bandwidth \(B > B_c\)
\$\textbackslash rightarrow\$ \textbf{Frequency-selective fading}
(different frequencies fade independently)

\textbf{Example}: Urban (\(\tau_{\text{rms}} = 1\ \mu\)s):

\[
B_c \approx \frac{1}{5 \times 10^{-6}} = 200\ \text{kHz}
\]

\begin{itemize}
\tightlist
\item
  \textbf{Narrowband signal} (\textless{} 200 kHz): Flat fading
\item
  \textbf{Wideband signal} (\textgreater{} 200 kHz): Frequency-selective
  fading (ISI)
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Intersymbol Interference
(ISI)}\label{intersymbol-interference-isi}

\textbf{Delayed multipath overlaps with next symbol}:

\textbf{Condition for ISI}:

\[
\tau_{\text{rms}} > T_s
\]

Where \(T_s\) = Symbol period

\textbf{Example}: 1 Mbps data (\(T_s = 1\ \mu\)s), urban channel
(\(\tau_{\text{rms}} = 3\ \mu\)s): - ISI severe (3 symbols overlap!) -
\textbf{Mitigation}: Equalization, OFDM (see
{[}{[}OFDM-\&-Multicarrier-Modulation{]}{]})

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Frequency-Domain Effects}\label{frequency-domain-effects}

\subsubsection{Doppler Shift}\label{doppler-shift}

\textbf{Relative motion between TX/RX causes frequency shift}:

\[
f_d = \frac{v}{\lambda} \cos(\theta)
\]

Where: - \(v\) = Velocity (m/s) - \(\theta\) = Angle between velocity
and signal direction - \(f_d\) = Doppler shift (Hz)

\textbf{Example}: Car at 100 km/h (27.8 m/s), 2 GHz signal:

\[
f_d = \frac{27.8}{0.15} \cos(0Â°) = 185\ \text{Hz}
\]

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Doppler Spread}\label{doppler-spread}

\textbf{Multiple paths with different Doppler shifts}:

\[
B_d = 2f_{d,\text{max}} = \frac{2v}{\lambda}
\]

\textbf{Coherence time} (how long channel stays constant):

\[
T_c \approx \frac{0.423}{B_d}
\]

\textbf{Example}: 100 km/h at 2 GHz:

\[
B_d = 2 \times 185 = 370\ \text{Hz}
\]

\[
T_c = \frac{0.423}{370} = 1.14\ \text{ms}
\]

\textbf{Implication}: Channel changes every \textasciitilde1 ms (fast
fading for stationary systems, slow fading for fast data rates)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Fading Classifications}\label{fading-classifications}

\subsubsection{Flat vs
Frequency-Selective}\label{flat-vs-frequency-selective}

{\def\LTcaptype{} % do not increment counter
\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.1622}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2973}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2162}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.3243}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Type
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Condition
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Effect
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Mitigation
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Flat} & \(B \ll B_c\) & All frequencies fade together &
Diversity, FEC \\
\textbf{Frequency-selective} & \(B \gg B_c\) & Different frequencies
fade independently & Equalization, OFDM \\
\end{longtable}
}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Fast vs Slow Fading}\label{fast-vs-slow-fading}

{\def\LTcaptype{} % do not increment counter
\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.1622}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2973}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2162}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.3243}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Type
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Condition
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Effect
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Mitigation
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Slow} & \(T_c \gg T_s\) & Channel constant over many symbols &
Interleaving, FEC \\
\textbf{Fast} & \(T_c \ll T_s\) & Channel changes within symbol &
Pilot-aided estimation \\
\end{longtable}
}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Rayleigh Fading}\label{rayleigh-fading}

\textbf{Occurs when}: \textbf{No dominant LOS path}, many scattered
components with random phases

\textbf{Statistical model}: Envelope follows \textbf{Rayleigh
distribution}

\subsubsection{PDF (Probability Density
Function)}\label{pdf-probability-density-function}

\[
p(r) = \frac{r}{\sigma^2} \exp\left(-\frac{r^2}{2\sigma^2}\right), \quad r \geq 0
\]

Where: - \(r\) = Signal envelope - \(\sigma^2\) = Average power

\textbf{Mean}: \(\bar{r} = \sigma\sqrt{\pi/2}\)

\textbf{Variance}: \(\text{Var}(r) = \sigma^2(2 - \pi/2)\)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{CDF (Cumulative Distribution
Function)}\label{cdf-cumulative-distribution-function}

\textbf{Probability that signal \textless{} threshold}:

\[
P(r < R) = 1 - \exp\left(-\frac{R^2}{2\sigma^2}\right)
\]

\textbf{Example}: Probability signal drops below 10 dB below average:

\[
P(r < 0.316\bar{r}) = 1 - \exp(-0.05) \approx 5\%
\]

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Impact on BER}\label{impact-on-ber}

\textbf{Rayleigh fading severely degrades performance}:

\textbf{BPSK in Rayleigh fading}:

\[
\text{BER} = \frac{1}{2}\left(1 - \sqrt{\frac{\bar{\gamma}}{1 + \bar{\gamma}}}\right)
\]

Where \(\bar{\gamma} = E_b/N_0\) (average SNR)

\textbf{Comparison} (at 10 dB average SNR): - \textbf{AWGN}: BER = 3.9
\$\textbackslash times\$
10\textbackslash textsuperscript\{-\}\textbackslash textsuperscript\{6\}
- \textbf{Rayleigh fading}: BER = 0.005 (1000\$\textbackslash times\$
worse!)

\textbf{Key insight}: Deep fades cause \textbf{error bursts} (when
signal drops into noise floor)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Applications}\label{applications}

\textbf{Typical Rayleigh environments}: - Dense urban (no LOS, many
reflections) - Indoor (office, corridors) - Suburban/rural (obstructed
by trees/buildings)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Rician Fading}\label{rician-fading}

\textbf{Occurs when}: \textbf{Dominant LOS path + scattered components}

\textbf{Statistical model}: Envelope follows \textbf{Rician
distribution}

\subsubsection{PDF}\label{pdf}

\[
p(r) = \frac{r}{\sigma^2} \exp\left(-\frac{r^2 + A^2}{2\sigma^2}\right) I_0\left(\frac{Ar}{\sigma^2}\right)
\]

Where: - \(A\) = Amplitude of LOS component - \(I_0\) = Modified Bessel
function of first kind, order 0

\textbf{Rician K-factor}:

\[
K = \frac{A^2}{2\sigma^2} = \frac{\text{LOS power}}{\text{Scattered power}}
\]

\textbf{K in dB}: \(K_{\text{dB}} = 10\log_{10}(K)\)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Interpretation of
K-factor}\label{interpretation-of-k-factor}

{\def\LTcaptype{} % do not increment counter
\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
K (dB) & Environment & Fading Severity \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{-\$\textbackslash infty\$ (K=0)} & No LOS (pure Rayleigh) &
\textbf{Severe} (deep fades) \\
\textbf{0 dB (K=1)} & Equal LOS/scatter & Moderate \\
\textbf{6 dB (K=4)} & Strong LOS & Mild \\
\textbf{10 dB (K=10)} & Dominant LOS & Negligible fading \\
\textbf{+\$\textbackslash infty\$} & Pure LOS (AWGN-like) & None \\
\end{longtable}
}

\textbf{Special case}: \(K = 0\) \$\textbackslash rightarrow\$ Rayleigh
fading (Rician generalizes Rayleigh)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Impact on BER}\label{impact-on-ber-1}

\textbf{Rician fading is less severe than Rayleigh}:

\textbf{BPSK in Rician fading}:

\[
\text{BER} = Q\left(\sqrt{\frac{2K\bar{\gamma}}{K+1}}\right) \exp\left(-\frac{K\bar{\gamma}}{K+1}\right) \times ...
\]

(Complex expression, see textbooks)

\textbf{Comparison} (10 dB average SNR): - \textbf{AWGN}: BER = 3.9
\$\textbackslash times\$
10\textbackslash textsuperscript\{-\}\textbackslash textsuperscript\{6\}
- \textbf{Rician K=6 dB}: BER \$\textbackslash approx\$
10\textbackslash textsuperscript\{-\}\textbackslash textsuperscript\{5\}
(better than Rayleigh, worse than AWGN) - \textbf{Rayleigh (K=0)}: BER =
0.005

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Applications}\label{applications-1}

\textbf{Typical Rician environments}: - Suburban with partial LOS -
Elevated antennas (rooftops) - Satellite-to-handheld (weak LOS + ground
reflections) - Indoor near windows (outdoor LOS + indoor scatter)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Fade Depth \& Duration}\label{fade-depth-duration}

\subsubsection{Fade Margin}\label{fade-margin}

\textbf{Link budget must include fade margin} to maintain target
availability:

\[
P_r(\text{min}) = P_r(\text{average}) - M_{\text{fade}}
\]

\textbf{Example}: Target 99\% availability (1\% outage)

\textbf{Rayleigh fading}: 10\% of time, signal \textless{} -10 dB below
average - Need \textbf{10 dB margin} for 90\% availability - Need
\textbf{20 dB margin} for 99\% availability

\textbf{Rician K=6 dB}: Fades less severe - \textasciitilde5 dB margin
for 90\% - \textasciitilde10 dB margin for 99\%

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Level Crossing Rate (LCR)}\label{level-crossing-rate-lcr}

\textbf{How often signal crosses threshold} (in fades/sec):

\[
N_R = \sqrt{2\pi} f_d \rho \exp(-\rho^2)
\]

Where: - \(f_d\) = Maximum Doppler frequency -
\(\rho = R/R_{\text{rms}}\) (normalized threshold)

\textbf{Example}: Mobile at 100 km/h, 2 GHz (\(f_d = 185\) Hz),
threshold = average power (\(\rho = 1\)):

\[
N_R = \sqrt{2\pi} \times 185 \times 1 \times \exp(-1) \approx 85\ \text{fades/sec}
\]

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Average Fade Duration}\label{average-fade-duration}

\[
\bar{t} = \frac{\exp(\rho^2) - 1}{\rho f_d \sqrt{2\pi}}
\]

\textbf{Example}: Same scenario, threshold = average:

\[
\bar{t} = \frac{e - 1}{1 \times 185 \times \sqrt{2\pi}} \approx 3.7\ \text{ms}
\]

\textbf{Implication}: Fast fading (85 fades/sec), short fades
(\textasciitilde4 ms) \$\textbackslash rightarrow\$ Interleaving
effective

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Mitigation Techniques}\label{mitigation-techniques}

\subsubsection{1. Diversity}\label{diversity}

\textbf{Combine multiple independent fading signals}:

\paragraph{Spatial Diversity (Antenna
Diversity)}\label{spatial-diversity-antenna-diversity}

\textbf{Separate antennas by} \(d > \lambda/2\):

\textbf{Diversity gain}: \textasciitilde10 dB improvement with 2
antennas (selection combining)

\textbf{Example}: WiFi access point with 2 antennas (2.4 GHz,
\(\lambda = 12.5\) cm): - Antenna spacing: 6 cm minimum - Result:
Probability both antennas in deep fade is very low

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\paragraph{Frequency Diversity}\label{frequency-diversity}

\textbf{Transmit same data on multiple frequencies} separated by
\(> B_c\):

\textbf{Application}: Frequency hopping spread spectrum (FHSS)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\paragraph{Time Diversity}\label{time-diversity}

\textbf{Transmit same data at different times} separated by \(> T_c\):

\textbf{Implementation}: Interleaving + FEC (spread coded bits over
time)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{2. Equalization}\label{equalization}

\textbf{Compensate for frequency-selective fading} (ISI):

\paragraph{Linear Equalization (LE)}\label{linear-equalization-le}

\textbf{Zero-forcing (ZF)}: Invert channel response

\[
H_{\text{eq}}(f) = \frac{1}{H_{\text{channel}}(f)}
\]

\textbf{Problem}: Noise amplification at deep fades

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\paragraph{Decision-Feedback Equalization
(DFE)}\label{decision-feedback-equalization-dfe}

\textbf{Use past decisions} to cancel ISI:

\textbf{Better than ZF}: Doesn\textquotesingle t amplify noise as much

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\paragraph{Adaptive Equalization}\label{adaptive-equalization}

\textbf{Track time-varying channel}:

\textbf{Algorithms}: LMS (Least Mean Squares), RLS (Recursive Least
Squares)

\textbf{Training}: Periodic pilot symbols to update equalizer
coefficients

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{3. OFDM}\label{ofdm}

\textbf{Divide wideband signal into many narrowband subcarriers}:

\textbf{Each subcarrier \textless{} \(B_c\)}
\$\textbackslash rightarrow\$ Flat fading per subcarrier

\textbf{Per-subcarrier equalization}: Simple single-tap equalizer

\textbf{See}: {[}{[}OFDM-\&-Multicarrier-Modulation{]}{]}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{4. Spread Spectrum}\label{spread-spectrum}

\textbf{Spread signal over wide bandwidth}:

\textbf{Frequency diversity}: Different frequency components fade
independently

\textbf{See}: {[}{[}Spread-Spectrum-(DSSS-FHSS){]}{]}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{5. Error Correction
Coding}\label{error-correction-coding}

\textbf{FEC protects against error bursts}:

\textbf{Interleaving}: Spread coded bits across time/frequency

\textbf{Example}: Convolutional code + interleaver - Error burst of 10
bits \$\textbackslash rightarrow\$ Spread across 100+ bit positions -
Decoder sees isolated errors (easier to correct)

\textbf{See}: {[}{[}Forward-Error-Correction-(FEC){]}{]},
{[}{[}LDPC-Codes{]}{]}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Channel Models}\label{channel-models}

\subsubsection{Rayleigh Fading Channel
(MATLAB/Python)}\label{rayleigh-fading-channel-matlabpython}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\KeywordTok{def}\NormalTok{ rayleigh\_fading(N, fd, fs):}
    \CommentTok{"""}
\CommentTok{    Generate Rayleigh fading samples}
\CommentTok{    N: Number of samples}
\CommentTok{    fd: Maximum Doppler frequency (Hz)}
\CommentTok{    fs: Sampling frequency (Hz)}
\CommentTok{    """}
    \CommentTok{\# Jakes\textquotesingle{} model (sum of sinusoids)}
\NormalTok{    M }\OperatorTok{=} \DecValTok{8}  \CommentTok{\# Number of scatterers}
\NormalTok{    t }\OperatorTok{=}\NormalTok{ np.arange(N) }\OperatorTok{/}\NormalTok{ fs}
    
\NormalTok{    h\_real }\OperatorTok{=}\NormalTok{ np.zeros(N)}
\NormalTok{    h\_imag }\OperatorTok{=}\NormalTok{ np.zeros(N)}
    
    \ControlFlowTok{for}\NormalTok{ m }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(M):}
\NormalTok{        theta\_m }\OperatorTok{=} \DecValTok{2}\OperatorTok{*}\NormalTok{np.pi}\OperatorTok{*}\NormalTok{m }\OperatorTok{/}\NormalTok{ M}
\NormalTok{        phi\_m }\OperatorTok{=}\NormalTok{ np.random.uniform(}\DecValTok{0}\NormalTok{, }\DecValTok{2}\OperatorTok{*}\NormalTok{np.pi)}
\NormalTok{        h\_real }\OperatorTok{+=}\NormalTok{ np.cos(}\DecValTok{2}\OperatorTok{*}\NormalTok{np.pi}\OperatorTok{*}\NormalTok{fd}\OperatorTok{*}\NormalTok{t}\OperatorTok{*}\NormalTok{np.cos(theta\_m) }\OperatorTok{+}\NormalTok{ phi\_m)}
\NormalTok{        h\_imag }\OperatorTok{+=}\NormalTok{ np.sin(}\DecValTok{2}\OperatorTok{*}\NormalTok{np.pi}\OperatorTok{*}\NormalTok{fd}\OperatorTok{*}\NormalTok{t}\OperatorTok{*}\NormalTok{np.cos(theta\_m) }\OperatorTok{+}\NormalTok{ phi\_m)}
    
\NormalTok{    h\_real }\OperatorTok{/=}\NormalTok{ np.sqrt(M)}
\NormalTok{    h\_imag }\OperatorTok{/=}\NormalTok{ np.sqrt(M)}
    
\NormalTok{    h }\OperatorTok{=}\NormalTok{ h\_real }\OperatorTok{+} \OtherTok{1j}\OperatorTok{*}\NormalTok{h\_imag}
    \ControlFlowTok{return}\NormalTok{ h }\OperatorTok{/}\NormalTok{ np.sqrt(np.mean(np.}\BuiltInTok{abs}\NormalTok{(h)}\OperatorTok{**}\DecValTok{2}\NormalTok{))  }\CommentTok{\# Normalize}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Rician Fading Channel}\label{rician-fading-channel}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ rician\_fading(N, K\_dB, fd, fs):}
    \CommentTok{"""}
\CommentTok{    Generate Rician fading samples}
\CommentTok{    K\_dB: Rician K{-}factor (dB)}
\CommentTok{    """}
\NormalTok{    K }\OperatorTok{=} \DecValTok{10}\OperatorTok{**}\NormalTok{(K\_dB}\OperatorTok{/}\DecValTok{10}\NormalTok{)  }\CommentTok{\# Convert to linear}
    
    \CommentTok{\# Rayleigh component (scattered)}
\NormalTok{    h\_scatter }\OperatorTok{=}\NormalTok{ rayleigh\_fading(N, fd, fs)}
    
    \CommentTok{\# LOS component}
\NormalTok{    h\_los }\OperatorTok{=}\NormalTok{ np.sqrt(K }\OperatorTok{/}\NormalTok{ (K}\OperatorTok{+}\DecValTok{1}\NormalTok{))}
    
    \CommentTok{\# Scattered component scaled}
\NormalTok{    h\_scatter }\OperatorTok{*=}\NormalTok{ np.sqrt(}\DecValTok{1} \OperatorTok{/}\NormalTok{ (K}\OperatorTok{+}\DecValTok{1}\NormalTok{))}
    
    \ControlFlowTok{return}\NormalTok{ h\_los }\OperatorTok{+}\NormalTok{ h\_scatter}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Practical Examples}\label{practical-examples}

\subsubsection{Example 1: Urban Cellular (900
MHz)}\label{example-1-urban-cellular-900-mhz}

\textbf{Environment}: Dense urban, NLOS

\textbf{Parameters}: - Delay spread: \(\tau_{\text{rms}} = 3\ \mu\)s -
Doppler: \(f_d = 50\) Hz (30 km/h) - Fading: Rayleigh

\textbf{Coherence bandwidth}:

\[
B_c = \frac{1}{5 \times 3 \times 10^{-6}} = 67\ \text{kHz}
\]

\textbf{Implication}: GSM channel (200 kHz) experiences
frequency-selective fading \$\textbackslash rightarrow\$ Equalizer
needed

\textbf{Coherence time}:

\[
T_c = \frac{0.423}{100} = 4.23\ \text{ms}
\]

\textbf{Implication}: Channel constant over \textasciitilde18 GSM
symbols (0.577 ms/symbol) \$\textbackslash rightarrow\$ Slow fading

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Example 2: Suburban LTE (2.6
GHz)}\label{example-2-suburban-lte-2.6-ghz}

\textbf{Environment}: Suburban, partial LOS

\textbf{Parameters}: - Delay spread: \(\tau_{\text{rms}} = 0.5\ \mu\)s -
Doppler: \(f_d = 240\) Hz (100 km/h) - Fading: Rician K=5 dB

\textbf{Coherence bandwidth}:

\[
B_c = \frac{1}{5 \times 0.5 \times 10^{-6}} = 400\ \text{kHz}
\]

\textbf{Implication}: LTE RB (180 kHz) \textless{} \(B_c\)
\$\textbackslash rightarrow\$ Mostly flat fading per RB

\textbf{Coherence time}:

\[
T_c = \frac{0.423}{480} = 0.88\ \text{ms}
\]

\textbf{Implication}: Channel changes over \textasciitilde12 OFDM
symbols (71 \$\textbackslash mu\$s/symbol) \$\textbackslash rightarrow\$
Moderate fading, pilot-aided tracking

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Summary Table}\label{summary-table}

{\def\LTcaptype{} % do not increment counter
\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2500}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2273}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.3864}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.1364}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Parameter
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Rayleigh
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Rician (K=6 dB)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
AWGN
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{LOS component} & None & Dominant & Pure LOS \\
\textbf{Fade depth (10\% time)} & -10 dB & -5 dB & 0 dB \\
\textbf{BER penalty @ 10 dB SNR} & 1000\$\textbackslash times\$ &
10\$\textbackslash times\$ & 1\$\textbackslash times\$ (baseline) \\
\textbf{Mitigation} & Diversity, FEC & Moderate FEC & Minimal FEC \\
\textbf{Typical environment} & Dense urban, indoor & Suburban, elevated
& Free space, satellite \\
\end{longtable}
}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Related Topics}\label{related-topics}

\begin{itemize}
\tightlist
\item
  \textbf{{[}{[}Propagation-Modes-(Ground-Wave,-Sky-Wave,-Line-of-Sight){]}{]}}:
  LOS vs NLOS propagation
\item
  \textbf{{[}{[}Atmospheric-Effects-(Ionospheric,-Tropospheric){]}{]}}:
  Clear-air effects (different from multipath)
\item
  \textbf{{[}{[}Signal-to-Noise-Ratio-(SNR){]}{]}}: Fading reduces
  instantaneous SNR
\item
  \textbf{{[}{[}Bit-Error-Rate-(BER){]}{]}}: Fading degrades BER
  significantly
\item
  \textbf{{[}{[}QPSK-Modulation{]}{]}} /
  \textbf{{[}{[}LDPC-Codes{]}{]}}: Require fade mitigation
\item
  \textbf{{[}{[}OFDM-\&-Multicarrier-Modulation{]}{]}}: Combats
  frequency-selective fading
\item
  \textbf{{[}{[}Spread-Spectrum-(DSSS-FHSS){]}{]}}: Provides frequency
  diversity
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Key takeaway}: \textbf{Multipath fading is the dominant
impairment} in mobile/urban wireless. Rayleigh fading (no LOS) is
severe, Rician fading (with LOS) is moderate. Mitigation requires
diversity, equalization, OFDM, and robust FEC. Understanding \(B_c\) and
\(T_c\) is critical for system design.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\emph{This wiki is part of the {[}{[}Home\textbar Chimera Project{]}{]}
documentation.}
