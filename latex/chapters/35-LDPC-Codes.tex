% ==============================================================================
% CHAPTER 35: Low-Density Parity-Check (LDPC) Codes
% ==============================================================================

\chapter{Low-Density Parity-Check (LDPC) Codes}
\label{ch:ldpc}

\begin{nontechnical}
    \textbf{LDPC codes are like solving a massive, interconnected Sudoku puzzle to fix errors.} They are one of the most powerful error-correcting codes ever invented, and they are the engine behind 5G, modern WiFi, and satellite TV.

    \parhead{The simple idea: Belief Propagation}
    Instead of a single, complex check, an LDPC code uses thousands of simple parity checks that are interconnected in a sparse, web-like structure.
    \begin{itemize}
        \item Each data bit is a "number" in the puzzle.
        \item Each parity check is a "rule" that a small group of bits must satisfy (e.g., "these four bits must sum to an even number").
        \item The decoder works by passing messages back and forth: "This bit is probably a 1, which means one of you other three must be a 0 to satisfy my rule."
    \end{itemize}
    This process of "belief propagation" iterates, with each node updating its confidence based on messages from its neighbours, until the entire puzzle converges to a single, error-free solution.

    \parhead{Why they are the new standard}
    LDPC codes were invented in 1962 but were forgotten for over 30 years because the computers of the era were not powerful enough to run the iterative decoder. Rediscovered in the 1990s, their performance was found to be incredibly close to the theoretical Shannon limit. Their structure is also highly parallelisable, making them perfect for modern hardware.

    \parhead{Where they are used}
    \begin{itemize}
        \item \textbf{5G Mobile Networks:} LDPC is the standard code for all data channels.
        \item \textbf{WiFi 6/7 (802.11ax/be):} Replaced older codes to enable higher speeds and better range.
        \item \textbf{Satellite TV (DVB-S2):} The standard for modern satellite broadcasting.
        \item \textbf{Solid-State Drives (SSDs):} Used to correct errors as the flash memory wears out, dramatically extending the drive's lifespan.
    \end{itemize}
\end{nontechnical}


\subsection{Overview}

\keyterm{Low-Density Parity-Check (LDPC)} codes are a class of high-performance linear block codes that have become the dominant Forward Error Correction (FEC) scheme in many modern communication standards. Their defining characteristic is a \keyterm{parity-check matrix}, $\mathbf{H}$, that is \emph{sparse}â€”containing very few non-zero entries.

This sparsity is the key to their power. It allows for a low-complexity, highly parallelisable iterative decoding algorithm known as \keyterm{belief propagation} (or message passing). This algorithm enables LDPC codes to achieve performance that is often within a few hundredths of a decibel of the theoretical Shannon limit.

\begin{keyconcept}
    LDPC codes offer the best of both worlds: the near-capacity performance of Turbo codes, but with a more parallelisable decoder structure and a lower, or even non-existent, error floor. This combination of performance and practical implementation advantages is why they have superseded Turbo codes in the latest generation of high-throughput standards like 5G and WiFi 6.
\end{keyconcept}


\subsection{Code Structure}

An LDPC code is defined by its sparse $m \times n$ parity-check matrix, $\mathbf{H}$. A binary vector $\mathbf{c}$ of length $n$ is a valid codeword if and only if it satisfies the parity check equation:
\begin{equation}
    \mathbf{H}\mathbf{c}^T = \mathbf{0} \pmod 2
\end{equation}
The structure of this matrix is often visualised as a \keyterm{Tanner graph}, a bipartite graph with "variable nodes" representing the codeword bits and "check nodes" representing the parity-check equations. The sparseness of $\mathbf{H}$ translates to a graph with very few edges, which is the key to the decoder's efficiency.


\subsection{Iterative Decoding: Belief Propagation}

The LDPC decoder works by passing "messages" back and forth between the variable nodes and check nodes on the Tanner graph. These messages are \keyterm{Log-Likelihood Ratios (LLRs)}, which represent the probability or "belief" that a given bit is a '0' or a '1'.
\begin{description}
    \item[The Variable Node Step] Each variable node collects the messages from its connected check nodes and combines them with the information it received from the channel. It then sends an updated belief about its own value back out to each check node.
    \item[The Check Node Step] Each check node receives beliefs from its connected variable nodes. Knowing that the sum of these bits must be zero (even parity), it calculates a message to send back to each variable node, telling it what its value "should be" in order to satisfy the parity check equation, given the current beliefs of all the other nodes.
\end{description}
This process repeats, with the beliefs across the entire graph being iteratively refined until the decoder either converges on a valid codeword or a maximum number of iterations is reached.


\subsection{Performance Characteristics}

\paragraph{Near-Capacity Performance}
Well-designed LDPC codes exhibit a sharp "waterfall" in their BER performance curve, achieving very low error rates at an $E_b/N_0$ that is often less than 0.5 dB away from the Shannon limit.

\paragraph{Error Floor}
Compared to Turbo codes, LDPC codes generally have a much lower \keyterm{error floor}. By carefully designing the Tanner graph to avoid small problematic structures (like short cycles), the BER can continue to decrease with increasing SNR, making them suitable for applications requiring extremely high reliability (e.g., BER < $10^{-12}$).

\begin{table}[H]
    \centering
    \caption{Performance Comparison: LDPC vs. Turbo Codes (Rate 1/2)}
    \label{tab:ldpc-vs-turbo}
    \begin{tabular}{@{}lll@{}}
        \toprule
        \tableheaderfont Characteristic & \tableheaderfont LDPC Codes & \tableheaderfont Turbo Codes \\
        \midrule
        Waterfall Threshold & Excellent ($\sim$0.5 dB from Shannon) & Excellent ($\sim$0.7 dB from Shannon) \\
        Error Floor & Very Low ($<10^{-10}$) & Moderate ($>10^{-8}$) \\
        Decoder Parallelism & High (inherently parallel) & Low (inherently serial) \\
        Latency & Lower & Higher \\
        Primary Application & 5G, WiFi 6, DVB-S2 & 3G, 4G LTE \\
        \bottomrule
    \end{tabular}
\end{table}


\begin{workedexample}{DVB-S2 Link Analysis with LDPC}
    \parhead{Problem} A satellite TV link uses the DVB-S2 standard. Determine the required $E_b/N_0$ to achieve "quasi-error-free" performance (post-FEC BER < $10^{-7}$).
    \parhead{System Parameters}
    \begin{itemize}
        \item Modulation: 8-PSK.
        \item FEC: DVB-S2 standard LDPC code with rate $R=3/4$.
    \end{itemize}
    \parhead{Analysis}
    \begin{derivationsteps}
        \step \textbf{Find the uncoded requirement.} From standard performance curves, uncoded 8-PSK requires an $E_b/N_0$ of approximately \textbf{14.0 dB} to achieve a BER of $10^{-7}$.
        \step \textbf{Find the coded requirement.} The DVB-S2 standard specifies the performance for each modulation and coding pair. For 8-PSK with a rate-3/4 LDPC code, the specified required $E_b/N_0$ is only \textbf{5.5 dB}.
        \step \textbf{Calculate the Coding Gain.}
        \[ \text{Coding Gain} = (\text{Required } E_b/N_0)_{\text{uncoded}} - (\text{Required } E_b/N_0)_{\text{coded}} \]
        \[ \text{Coding Gain} = 14.0 \text{ dB} - 5.5 \text{ dB} = \textbf{\qty{8.5}{dB}} \]
    \end{derivationsteps}
    \parhead{Interpretation} The powerful LDPC code provides a massive 8.5 dB of coding gain. This means the system can operate with seven times less power than an uncoded system. It allows a user with a small satellite dish to receive high-definition video reliably, even in marginal weather conditions, by transforming a noisy, error-prone channel into a virtually error-free one.
\end{workedexample}


\begin{importantbox}[title={Further Reading}]
    LDPC codes represent the current state-of-the-art in practical error correction for high-throughput systems.
    \begin{description}
        \item[Turbo Codes] (\Cref{ch:turbo-codes}) are the main historical competitor to LDPC codes, and understanding their iterative decoding principle provides context for LDPC's message-passing algorithm.
        \item[Shannon's Channel Capacity] (\Cref{ch:shannon}) is the theoretical benchmark that LDPC codes come so remarkably close to achieving.
        \item[Modern Wireless Systems] (e.g., \Cref{ch:5g}, \Cref{ch:wifi}) provide detailed case studies of how LDPC codes are implemented in the world's most advanced communication standards.
    \end{description}
\end{importantbox}