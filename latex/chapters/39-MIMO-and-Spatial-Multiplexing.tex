\section{MIMO \& Spatial Multiplexing}\label{mimo-spatial-multiplexing}

\subsection{\texorpdfstring{ For Non-Technical
Readers}{ For Non-Technical Readers}}\label{for-non-technical-readers}

\textbf{MIMO is like having multiple conversations in the same
room-\/-\/-each person talks to their own partner, and everyone gets
through faster!}

\textbf{What is MIMO?} \textbf{M}ultiple \textbf{I}nput,
\textbf{M}ultiple \textbf{O}utput = Multiple antennas on both
transmitter and receiver

\textbf{The magic trick}: 1. Your WiFi router has 3 antennas 2. Your
laptop has 3 antennas 3. All 3 can send/receive \textbf{simultaneously}
on the same frequency! 4. Result: \textbf{3\$\textbackslash times\$
faster} than single antenna

\textbf{Real-world example - WiFi}: - \textbf{1\$\textbackslash times\$1
(no MIMO)}: 1 antenna, 150 Mbps - \textbf{2\$\textbackslash times\$2
MIMO}: 2 antennas, 300 Mbps - \textbf{4\$\textbackslash times\$4 MIMO}:
4 antennas, 600 Mbps - \textbf{8\$\textbackslash times\$8 MIMO} (WiFi
6): 8 antennas, 1200+ Mbps!

\textbf{How does it work?} - Signals bounce off walls/furniture
differently for each antenna - Receiver uses math to ``unmix'' the
overlapping signals - It\textquotesingle s like picking out one
conversation in a crowded party-\/-\/-your brain does it with sound,
MIMO does it with radio waves

\textbf{When you see it}: - \textbf{``AC1900'' WiFi}: Usually means
3\$\textbackslash times\$3 MIMO - \textbf{5G phone}: Has 4+ antennas for
MIMO - \textbf{Your router\textquotesingle s multiple antennas}:
That\textquotesingle s MIMO hardware!

\textbf{Fun fact}: Massive MIMO (64+ antennas!) is why 5G base stations
look like big panels instead of simple poles.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Multiple-Input Multiple-Output (MIMO)} uses multiple antennas at
both transmitter and receiver to dramatically increase data rates and
reliability. MIMO is the technological breakthrough that powers modern
wireless: WiFi 4/5/6/7, LTE, 5G, and beyond.

\textbf{Key insight}: The wireless channel is not a
scalar-\/-\/-it\textquotesingle s a \textbf{matrix}. Multiple spatial
paths can carry independent data streams simultaneously.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ The MIMO
Revolution}{ The MIMO Revolution}}\label{the-mimo-revolution}

\subsubsection{Before MIMO (SISO - Single-Input
Single-Output)}\label{before-mimo-siso---single-input-single-output}

\begin{verbatim}
TX Antenna )))  ···  (((  RX Antenna
               
          Single path
          
Capacity: C = B · log(1 + SNR)  bits/s
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{With MIMO (nT \$\textbackslash times\$ nR
Configuration)}\label{with-mimo-nt-nr-configuration}

\begin{verbatim}
TX Ant 1 )))    (((  RX Ant 1
TX Ant 2 )))    (((  RX Ant 2
TX Ant 3 )))    (((  RX Ant 3
              
        Multiple spatial paths
        (each can carry data!)

Capacity: C  min(nT, nR) · B · log(1 + SNR)  bits/s
\end{verbatim}

\textbf{Multiplier}: Capacity grows \textbf{linearly} with min(nT, nR)
antennas!

\textbf{Example}:

\begin{verbatim}
4×4 MIMO vs. SISO (same power, bandwidth, SNR):
- SISO: 20 Mbps
- 4×4 MIMO: 80 Mbps (4× improvement!)
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ MIMO Channel
Model}{ MIMO Channel Model}}\label{mimo-channel-model}

\subsubsection{Matrix Representation}\label{matrix-representation}

\begin{verbatim}
y = H·x + n

where:
- x = [x, x, ..., x_nT]^{T} : transmitted vector (nT × 1)
- y = [y, y, ..., y_nR]^{T} : received vector (nR × 1)
- H = channel matrix (nR × nT)
- n = noise vector (nR × 1)

Channel matrix H:
     From TX antennas 
     +                    +
  To | h  h  ...  h|
  RX | h  h  ...  h|
Ants |                |
     | h_{r} h_{r} ...  h_{r}|
     +                    +

h_{i} = complex channel gain from TX antenna j to RX antenna i
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Channel Characteristics}\label{channel-characteristics}

\textbf{Rich scattering} (urban, indoor):

\begin{verbatim}
H = well-conditioned matrix (many independent paths)
 Full spatial multiplexing possible
 Capacity  min(nT, nR) streams
\end{verbatim}

\textbf{Line-of-sight} (rural, outdoor):

\begin{verbatim}
H  rank-1 matrix (single dominant path)
 Limited multiplexing gain
 Capacity  1 stream (but diversity gain remains)
\end{verbatim}

\textbf{Condition number}:

\begin{verbatim}
 = _max / _min  (ratio of largest to smallest singular value)

  1: Ideal MIMO (all paths equally strong)
 >> 1: Poor MIMO (paths correlated)
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ MIMO Gains (The ``Three
M\textquotesingle s'')}{ MIMO Gains (The ``Three M\textquotesingle s'')}}\label{mimo-gains-the-three-ms}

MIMO provides three distinct types of gains:

\subsubsection{1. Array Gain}\label{array-gain}

\textbf{Concept}: Coherently combine signals from multiple antennas
\$\textbackslash rightarrow\$ increase SNR.

\begin{verbatim}
SNR_MIMO = SNR_SISO + 10·log(nR)  dB

Example (4 RX antennas):
Array gain = 10·log(4) = 6 dB

Physical interpretation:
- 4 antennas collect 4× more power
- SNR improves by 4× (6 dB)
- Like having a more sensitive receiver
\end{verbatim}

\textbf{Note}: Requires \textbf{coherent combining} (Maximum Ratio
Combining - MRC).

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{2. Diversity Gain}\label{diversity-gain}

\textbf{Concept}: Combat fading by having multiple independent paths.

\textbf{Problem}: Fading causes signal to drop unpredictably.

\begin{verbatim}
Single antenna: P(deep fade) = p

Multiple antennas:
P(all fade simultaneously) = p^nD  (where nD = diversity order)

Example (4 antennas, p = 0.1):
- SISO: 10% chance of fade
- 4-branch diversity: (0.1)^4 = 0.01% chance all fade
\end{verbatim}

\textbf{Diversity order}:

\begin{verbatim}
nD  nT × nR  (maximum)

Achieved through:
- Space diversity (multiple antennas)
- Time diversity (interleaving, retransmissions)
- Frequency diversity (OFDM, spread spectrum)
\end{verbatim}

\textbf{Benefit}: Reduces outage probability, increases reliability.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{3. Multiplexing Gain (Spatial
Multiplexing)}\label{multiplexing-gain-spatial-multiplexing}

\textbf{Concept}: Transmit \textbf{independent data streams} on each
antenna simultaneously.

\begin{verbatim}
Multiplexing gain: min(nT, nR) parallel streams

Data rate multiplier = min(nT, nR)

Example (4×4 MIMO):
- Stream 1 on TX Ant 1: "Hello"
- Stream 2 on TX Ant 2: "World"
- Stream 3 on TX Ant 3: "From"
- Stream 4 on TX Ant 4: "MIMO"

All transmitted at same time, same frequency!

Receiver separates streams using channel matrix H.
\end{verbatim}

\textbf{This is the headline MIMO gain} that enables gigabit wireless.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ MIMO
Techniques}{ MIMO Techniques}}\label{mimo-techniques}

\subsubsection{Spatial Multiplexing (SM)}\label{spatial-multiplexing-sm}

\textbf{Goal}: Maximize data rate.

\textbf{Transmitter}: Split data into nT streams, transmit
simultaneously.

\textbf{Receiver}: Separate streams by exploiting spatial signatures.

\begin{verbatim}
Detection methods:

1. Zero-Forcing (ZF):
   x = (H^H·H)^(-1)·H^H·y
   
   Nulls interference but amplifies noise.

2. MMSE (Minimum Mean Square Error):
   x = (H^H·H + ²I)^(-1)·H^H·y
   
   Balances interference and noise.

3. Maximum Likelihood (ML):
   x = argmin_x ||y - H·x||²
   
   Optimal but exponentially complex (test all possibilities).

4. Successive Interference Cancellation (SIC):
   Decode strongest stream first, subtract, repeat.
   
   Used in V-BLAST architecture.
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Transmit Beamforming
(TxBF)}\label{transmit-beamforming-txbf}

\textbf{Goal}: Focus energy toward specific receiver(s).

\textbf{Method}: Apply precoding weights to create constructive
interference at receiver.

\begin{verbatim}
Transmit signal: x = W·s

where:
- s = data streams
- W = precoding matrix (nT × nS, where nS  nT)

Beamforming vector (single stream):
w = v  (principal right singular vector of H)

Result: Maximum SNR at receiver (array gain + beamforming gain).
\end{verbatim}

\textbf{Types}:

\textbf{1. Eigenbeamforming} (SVD-based):

\begin{verbatim}
H = U··V^H  (Singular Value Decomposition)

Precoder: W = V (right singular vectors)
Combiner: U^H (left singular vectors)

Result: Decomposes MIMO channel into parallel SISO channels:
y_eff = ·s + n'

Each stream sees gain _{i} (singular value).
\end{verbatim}

\textbf{2. Zero-Forcing Beamforming} (MU-MIMO):

\begin{verbatim}
Multiple users, each with 1 antenna.
Design W so that:
H·W = [0 ... 1 ... 0]  (only user k receives signal)

W = H^H·(H·H^H)^(-1)

Eliminates inter-user interference (at cost of noise amplification).
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Diversity Combining}\label{diversity-combining}

\textbf{Goal}: Maximize reliability (minimize BER).

\textbf{Transmit Diversity} (Alamouti Code):

\begin{verbatim}
2×1 MIMO: 2 TX antennas, 1 RX antenna

Time:    t        t
TX1:    +s       -s*
TX2:    +s       +s*

Receiver combines:
r = h·s + h·s + n
r = -h·s* + h·s* + n

Solve for s, s:
 = h*·r + h·r*    SNR = (|h|² + |h|²)·Es/N
 = h*·r - h·r*    SNR = (|h|² + |h|²)·Es/N

Diversity order: 2 (full transmit diversity)
No channel knowledge at TX required!
\end{verbatim}

\textbf{Properties}: - Orthogonal space-time block code (OSTBC) - Rate =
1 (1 symbol per time slot) - Generalizes to higher dimensions but with
rate loss

\textbf{Receive Diversity} (MRC - Maximum Ratio Combining):

\begin{verbatim}
nR receive antennas, combine optimally:

y = _{i} h_{i}*·r_{i}

SNR = _{i} |h_{i}|²·Es/N  (sum of branch SNRs)

Diversity order: nR
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Hybrid Schemes}\label{hybrid-schemes}

\textbf{Goal}: Balance multiplexing and diversity.

\textbf{Example}: 4\$\textbackslash times\$4 MIMO

\begin{verbatim}
Option 1: 4 spatial streams (max rate, min diversity)
Option 2: 2 spatial streams, each with 2-branch diversity
Option 3: 1 spatial stream, full 16-branch diversity

IEEE 802.11n: Adaptive based on channel quality.
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ Massive
MIMO}{ Massive MIMO}}\label{massive-mimo}

\textbf{Definition}: Large number of antennas (64-256+) at base station,
serving many users.

\subsubsection{Key Principles}\label{key-principles}

\textbf{1. Channel Hardening}:

\begin{verbatim}
As nT  :
(1/nT)·H^H·H  I  (identity matrix)

Fading averages out  channel becomes deterministic!
\end{verbatim}

\textbf{2. Favorable Propagation}:

\begin{verbatim}
User channels become orthogonal:
H^H·H  diagonal

Simple linear processing (MRC/MRT) becomes near-optimal.
\end{verbatim}

\textbf{3. Array Gain Scales}:

\begin{verbatim}
SNR  nT

Example (128 TX antennas):
Array gain = 10·log(128) = 21 dB
Can reduce TX power per antenna by 128× while maintaining coverage!
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Massive MIMO in 5G NR}\label{massive-mimo-in-5g-nr}

\begin{verbatim}
Base station:
- 64-256 antenna elements
- Typically 32-64 ports (virtualized)
- Beamforming in both azimuth and elevation

UE (user):
- 2-4 antennas
- Operates in TDD mode (channel reciprocity)

Benefits:
- 10× spectral efficiency (vs. LTE)
- 100× energy efficiency (W/bit)
- Serve 10-20 users per cell simultaneously (MU-MIMO)

Example (3.5 GHz, 100 MHz BW, 64 antennas):
- Peak throughput: 5 Gbps (single user)
- Aggregate: 20 Gbps (multi-user)
\end{verbatim}

\textbf{Challenges}: - \textbf{Pilot contamination}: Adjacent cells use
same pilot sequences \$\textbackslash rightarrow\$ interference -
\textbf{Hardware complexity}: 64+ RF chains, calibration - \textbf{CSI
acquisition}: Overhead for channel estimation

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ MIMO
Capacity}{ MIMO Capacity}}\label{mimo-capacity}

\subsubsection{Ergodic Capacity (Shannon
Limit)}\label{ergodic-capacity-shannon-limit}

\textbf{Water-filling}:

\begin{verbatim}
C = _{i} B·log(1 + _{i}·P/²)

where:
- _{i} = eigenvalues of H^H·H
- P = total transmit power
- Allocate power proportional to channel strength (water-filling)

With equal power allocation:
C  min(nT, nR)·B·log(1 + (nR/nT)·SNR)
\end{verbatim}

\textbf{IID Rayleigh Channel} (rich scattering):

\begin{verbatim}
E[C] = min(nT, nR)·B·log(e·SNR)  (high SNR)

Example (4×4 MIMO, 20 MHz, SNR = 20 dB):
C  4 × 20 MHz × log(100) = 533 Mbps

Compare SISO (1×1):
C  20 MHz × log(100) = 133 Mbps

MIMO gain: 4× capacity!
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Outage Capacity (Fading
Channels)}\label{outage-capacity-fading-channels}

\begin{verbatim}
C_outage() = max{R : P(C < R)  }

where  = outage probability (e.g., 1%)

Diversity reduces outage:
- SISO 1% outage: Need SNR = 20 dB for C = 1 bps/Hz
- 4×4 MIMO 1% outage: Need SNR = 10 dB for C = 4 bps/Hz

Net result: 10 dB SNR reduction + 4× rate increase!
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ MIMO in
Standards}{ MIMO in Standards}}\label{mimo-in-standards}

\subsubsection{WiFi Evolution}\label{wifi-evolution}

\textbf{802.11n (WiFi 4, 2009)}:

\begin{verbatim}
MIMO: 1×1, 2×2, 3×3, 4×4
Bandwidth: 20, 40 MHz
Modulation: Up to 64-QAM
Spatial streams: Max 4
Peak rate: 600 Mbps (4×4, 40 MHz, 64-QAM)

Techniques:
- Spatial multiplexing (SM)
- Space-time block coding (STBC) - Alamouti
- Transmit beamforming (TxBF)
\end{verbatim}

\textbf{802.11ac (WiFi 5, 2013)}:

\begin{verbatim}
MIMO: Up to 8×8
Bandwidth: 20, 40, 80, 160 MHz
Modulation: 256-QAM
MU-MIMO: Downlink (up to 4 users)
Peak rate: 6.9 Gbps (8×8, 160 MHz, 256-QAM)
\end{verbatim}

\textbf{802.11ax (WiFi 6, 2019)}:

\begin{verbatim}
MIMO: Up to 8×8
MU-MIMO: Downlink + Uplink (up to 8 users)
OFDMA: Multi-user on subcarrier groups
Spatial reuse: Coordinated interference management
Peak rate: 9.6 Gbps

Key innovation: Simultaneous UL/DL multi-user
\end{verbatim}

\textbf{802.11be (WiFi 7, 2024)}:

\begin{verbatim}
MIMO: Up to 16×16
Bandwidth: Up to 320 MHz
Modulation: 4096-QAM
Multi-link operation (MLO): Simultaneous bands
Peak rate: 46 Gbps
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{LTE \& 5G NR}\label{lte-5g-nr}

\textbf{LTE (4G)}:

\begin{verbatim}
Release 8 (2009):
- 2×2, 4×4 MIMO (downlink)
- Peak: 150 Mbps (2×2), 300 Mbps (4×4)

Release 10 (LTE-Advanced, 2011):
- 8×8 MIMO
- Carrier aggregation (up to 100 MHz)
- MU-MIMO (4 users)
- Peak: 1 Gbps

Release 13 (LTE-Pro, 2016):
- Massive MIMO (up to 128 TX antennas)
- 3D beamforming (elevation + azimuth)
- Peak: 3 Gbps
\end{verbatim}

\textbf{5G NR (5G)}:

\begin{verbatim}
FR1 (Sub-6 GHz):
- Massive MIMO: 64-256 antennas (BS), 2-4 (UE)
- MU-MIMO: 12+ users simultaneously
- Beamforming: Hybrid analog/digital
- Peak: 5 Gbps

FR2 (mmWave, 24-52 GHz):
- Ultra-massive MIMO: 256+ antenna elements
- Beamforming essential (overcome path loss)
- Beam management: Sweeping, tracking
- Peak: 20 Gbps

Techniques:
- mMIMO with ZF/MMSE precoding
- CSI-RS (Channel State Information Reference Signal)
- SRS (Sounding Reference Signal) for uplink CSI
- Codebook-based and CSI feedback
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ Advanced MIMO
Concepts}{ Advanced MIMO Concepts}}\label{advanced-mimo-concepts}

\subsubsection{Multi-User MIMO (MU-MIMO)}\label{multi-user-mimo-mu-mimo}

\textbf{Concept}: Base station with nT antennas serves K users (K
\$\textbackslash leq\$ nT) simultaneously.

\begin{verbatim}
Downlink:
BS: nT antennas  K users (each with 1 antenna)

Channel:
    + h^{T} +
H = | h^{T} |  (K × nT)
    |    |
    + h^{T} +

Precoding:
x = W·s  (nT × 1)

where W designed to null inter-user interference.

Capacity (sum rate):
C_sum =  B·log(1 + SINR)
\end{verbatim}

\textbf{Advantage over SU-MIMO}: - Single-antenna devices can benefit
from MIMO - No spatial multiplexing at UE required - Aggregate
throughput scales with number of users

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Coordinated Multi-Point
(CoMP)}\label{coordinated-multi-point-comp}

\textbf{Concept}: Multiple base stations coordinate to serve users.

\begin{verbatim}
Types:

1. Joint Transmission (JT):
   Multiple BSs transmit same data (coherent combining at UE)
    Diversity gain, extended coverage

2. Coordinated Scheduling/Beamforming (CS/CB):
   BSs coordinate to minimize interference
    Improved SINR at cell edges

3. Dynamic Point Selection (DPS):
   UE dynamically switches serving BS
    Load balancing
\end{verbatim}

\textbf{5G implementation}: Network slicing + CoMP for ultra-reliable
low-latency (URLLC).

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Full-Duplex MIMO}\label{full-duplex-mimo}

\textbf{Concept}: Transmit and receive simultaneously on same frequency.

\textbf{Challenge}: Self-interference (TX power
\textgreater\textgreater{} RX power, 100+ dB difference).

\textbf{Solutions}: 1. \textbf{Analog cancellation}: Circulators,
cross-polarization 2. \textbf{Digital cancellation}: Subtract TX signal
digitally 3. \textbf{MIMO spatial cancellation}: Null TX in RX
directions

\textbf{Benefit}: 2\$\textbackslash times\$ spectral efficiency (in
theory).

\textbf{Status}: Active research, not yet in standards (SI cancellation
still insufficient).

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ Performance
Analysis}{ Performance Analysis}}\label{performance-analysis}

\subsubsection{BER with MIMO}\label{ber-with-mimo}

\textbf{Alamouti 2\$\textbackslash times\$1 (BPSK)}:

\begin{verbatim}
BER = Q((2·(|h|² + |h|²)·Eb/N))

Average over Rayleigh fading:
BER  [1/(4·Eb/N)]²  (high SNR, diversity order = 2)

Compare SISO:
BER  1/(4·Eb/N)    (diversity order = 1)

At BER = 10³:
- SISO: Requires Eb/N  24 dB
- Alamouti: Requires Eb/N  12 dB
 12 dB diversity gain!
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsubsection{Spatial Multiplexing (ZF
Receiver)}\label{spatial-multiplexing-zf-receiver}

\begin{verbatim}
BER depends on post-detection SNR of each stream:

SNR_{i} = _{i}²·P / (²·||[(H^H·H)^(-1)]_{i}_{i}||²)

where _{i} = i-th singular value of H

For i.i.d. Rayleigh channel (4×4):
E[BER]  10³ at SNR  20 dB (64-QAM, rate-1/2 FEC)

Outage: If channel is poorly conditioned, one stream fails.
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ Python Implementation
Example}{ Python Implementation Example}}\label{python-implementation-example}

\subsubsection{MIMO Spatial Multiplexing
Simulation}\label{mimo-spatial-multiplexing-simulation}

% TODO: Fix long code block - currently causes TeX capacity exceeded error
% The Python code block below has been temporarily commented out to allow the book to build.
% Issue: Very long Shaded environment (110+ lines) with complex syntax highlighting

\begin{center}
\textit{[Python implementation code temporarily removed - see digital version or future edition]}
\end{center}

% \begin{Shaded}
% \begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{from}\NormalTok{ numpy.linalg }\ImportTok{import}\NormalTok{ inv}

\KeywordTok{def}\NormalTok{ generate\_mimo\_channel(nT, nR):}
    \CommentTok{"""}
\CommentTok{    Generate i.i.d. Rayleigh fading channel.}
\CommentTok{    }
\CommentTok{    Returns:}
\CommentTok{        H: nR × nT complex channel matrix}
\CommentTok{    """}
\NormalTok{    H\_real }\OperatorTok{=}\NormalTok{ np.random.randn(nR, nT)}
\NormalTok{    H\_imag }\OperatorTok{=}\NormalTok{ np.random.randn(nR, nT)}
\NormalTok{    H }\OperatorTok{=}\NormalTok{ (H\_real }\OperatorTok{+} \OtherTok{1j} \OperatorTok{*}\NormalTok{ H\_imag) }\OperatorTok{/}\NormalTok{ np.sqrt(}\DecValTok{2}\NormalTok{)}
    \ControlFlowTok{return}\NormalTok{ H}

\KeywordTok{def}\NormalTok{ mimo\_transmit(data\_streams, H, snr\_db):}
    \CommentTok{"""}
\CommentTok{    MIMO transmission with AWGN.}
\CommentTok{    }
\CommentTok{    Args:}
\CommentTok{        data\_streams: nT × N\_symbols (each row = spatial stream)}
\CommentTok{        H: nR × nT channel matrix}
\CommentTok{        snr\_db: Signal{-}to{-}noise ratio}
\CommentTok{    }
\CommentTok{    Returns:}
\CommentTok{        Received signal (nR × N\_symbols)}
\CommentTok{    """}
\NormalTok{    nR, nT }\OperatorTok{=}\NormalTok{ H.shape}
\NormalTok{    N\_symbols }\OperatorTok{=}\NormalTok{ data\_streams.shape[}\DecValTok{1}\NormalTok{]}
    
    \CommentTok{\# Transmit}
\NormalTok{    tx\_signal }\OperatorTok{=}\NormalTok{ data\_streams  }\CommentTok{\# nT × N\_symbols}
    
    \CommentTok{\# Channel}
\NormalTok{    rx\_signal }\OperatorTok{=}\NormalTok{ H }\OperatorTok{@}\NormalTok{ tx\_signal  }\CommentTok{\# nR × N\_symbols}
    
    \CommentTok{\# Add noise}
\NormalTok{    signal\_power }\OperatorTok{=}\NormalTok{ np.mean(np.}\BuiltInTok{abs}\NormalTok{(rx\_signal)}\OperatorTok{**}\DecValTok{2}\NormalTok{)}
\NormalTok{    noise\_power }\OperatorTok{=}\NormalTok{ signal\_power }\OperatorTok{/}\NormalTok{ (}\DecValTok{10}\OperatorTok{**}\NormalTok{(snr\_db}\OperatorTok{/}\DecValTok{10}\NormalTok{))}
\NormalTok{    noise }\OperatorTok{=}\NormalTok{ np.sqrt(noise\_power}\OperatorTok{/}\DecValTok{2}\NormalTok{) }\OperatorTok{*}\NormalTok{ (np.random.randn(nR, N\_symbols) }\OperatorTok{+} 
                                       \OtherTok{1j}\OperatorTok{*}\NormalTok{np.random.randn(nR, N\_symbols))}
    
\NormalTok{    rx\_signal }\OperatorTok{+=}\NormalTok{ noise}
    
    \ControlFlowTok{return}\NormalTok{ rx\_signal}

\KeywordTok{def}\NormalTok{ mimo\_zf\_receiver(rx\_signal, H):}
    \CommentTok{"""}
\CommentTok{    Zero{-}Forcing MIMO detection.}
\CommentTok{    }
\CommentTok{    Args:}
\CommentTok{        rx\_signal: nR × N\_symbols}
\CommentTok{        H: nR × nT channel matrix}
\CommentTok{    }
\CommentTok{    Returns:}
\CommentTok{        Estimated data streams (nT × N\_symbols)}
\CommentTok{    """}
    \CommentTok{\# ZF: x = (H\^{}H·H)\^{}({-}1)·H\^{}H·y}
\NormalTok{    H\_pinv }\OperatorTok{=}\NormalTok{ inv(H.conj().T }\OperatorTok{@}\NormalTok{ H) }\OperatorTok{@}\NormalTok{ H.conj().T}
\NormalTok{    estimated }\OperatorTok{=}\NormalTok{ H\_pinv }\OperatorTok{@}\NormalTok{ rx\_signal}
    \ControlFlowTok{return}\NormalTok{ estimated}

\CommentTok{\# Simulation}
\NormalTok{nT, nR }\OperatorTok{=} \DecValTok{4}\NormalTok{, }\DecValTok{4}  \CommentTok{\# 4×4 MIMO}
\NormalTok{N\_symbols }\OperatorTok{=} \DecValTok{1000}
\NormalTok{snr\_db }\OperatorTok{=} \DecValTok{20}

\CommentTok{\# Generate QPSK symbols}
\NormalTok{data\_streams }\OperatorTok{=}\NormalTok{ (}\DecValTok{2}\OperatorTok{*}\NormalTok{np.random.randint(}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{, (nT, N\_symbols)) }\OperatorTok{{-}} \DecValTok{1}\NormalTok{) }\OperatorTok{+} \OperatorTok{\textbackslash{}}
               \OtherTok{1j}\OperatorTok{*}\NormalTok{(}\DecValTok{2}\OperatorTok{*}\NormalTok{np.random.randint(}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{, (nT, N\_symbols)) }\OperatorTok{{-}} \DecValTok{1}\NormalTok{)}
\NormalTok{data\_streams }\OperatorTok{/=}\NormalTok{ np.sqrt(}\DecValTok{2}\NormalTok{)}

\CommentTok{\# Channel}
\NormalTok{H }\OperatorTok{=}\NormalTok{ generate\_mimo\_channel(nT, nR)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Channel condition number: }\SpecialCharTok{\{}\NormalTok{np}\SpecialCharTok{.}\NormalTok{linalg}\SpecialCharTok{.}\NormalTok{cond(H)}\SpecialCharTok{:.2f\}}\SpecialStringTok{"}\NormalTok{)}

\CommentTok{\# Singular value decomposition}
\NormalTok{U, S, Vh }\OperatorTok{=}\NormalTok{ np.linalg.svd(H)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Singular values: }\SpecialCharTok{\{}\NormalTok{S}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Rank: }\SpecialCharTok{\{}\NormalTok{np}\SpecialCharTok{.}\NormalTok{linalg}\SpecialCharTok{.}\NormalTok{matrix\_rank(H)}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}

\CommentTok{\# Transmit}
\NormalTok{rx\_signal }\OperatorTok{=}\NormalTok{ mimo\_transmit(data\_streams, H, snr\_db)}

\CommentTok{\# Receive (ZF)}
\NormalTok{estimated }\OperatorTok{=}\NormalTok{ mimo\_zf\_receiver(rx\_signal, H)}

\CommentTok{\# Compute symbol error rate (SER)}
\CommentTok{\# Hard decision to QPSK constellation}
\KeywordTok{def}\NormalTok{ qpsk\_detect(symbols):}
\NormalTok{    symbols\_normalized }\OperatorTok{=}\NormalTok{ symbols }\OperatorTok{/}\NormalTok{ np.}\BuiltInTok{abs}\NormalTok{(symbols)}
\NormalTok{    real\_bits }\OperatorTok{=}\NormalTok{ (symbols\_normalized.real }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{).astype(}\BuiltInTok{int}\NormalTok{)}
\NormalTok{    imag\_bits }\OperatorTok{=}\NormalTok{ (symbols\_normalized.imag }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{).astype(}\BuiltInTok{int}\NormalTok{)}
    \ControlFlowTok{return}\NormalTok{ real\_bits, imag\_bits}

\NormalTok{orig\_real, orig\_imag }\OperatorTok{=}\NormalTok{ qpsk\_detect(data\_streams)}
\NormalTok{est\_real, est\_imag }\OperatorTok{=}\NormalTok{ qpsk\_detect(estimated)}

\NormalTok{ber\_real }\OperatorTok{=}\NormalTok{ np.mean(orig\_real }\OperatorTok{!=}\NormalTok{ est\_real)}
\NormalTok{ber\_imag }\OperatorTok{=}\NormalTok{ np.mean(orig\_imag }\OperatorTok{!=}\NormalTok{ est\_imag)}
\NormalTok{ber }\OperatorTok{=}\NormalTok{ (ber\_real }\OperatorTok{+}\NormalTok{ ber\_imag) }\OperatorTok{/} \DecValTok{2}

\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"}\CharTok{\textbackslash{}n}\SpecialStringTok{4×4 MIMO ZF Receiver"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"SNR: }\SpecialCharTok{\{}\NormalTok{snr\_db}\SpecialCharTok{\}}\SpecialStringTok{ dB"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"BER: }\SpecialCharTok{\{}\NormalTok{ber}\SpecialCharTok{:.2\%\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Spatial streams: }\SpecialCharTok{\{}\NormalTok{nT}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
% \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Effective rate: }\SpecialCharTok{\{}\NormalTok{nT}\SpecialCharTok{\}}\SpecialStringTok{× single antenna"}\NormalTok{)}
% \end{Highlighting}
% \end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ When to Use
MIMO}{ When to Use MIMO}}\label{when-to-use-mimo}

\subsubsection{MIMO Excels:}\label{mimo-excels}

\textbf{Rich scattering} (urban, indoor environments)\\
\textbf{High data rate} requirements (gigabit wireless)\\
\textbf{Multi-user scenarios} (many devices per AP/BS)\\
\textbf{Coverage extension} (diversity, beamforming)\\
\textbf{Spectral efficiency} (limited spectrum available)

\subsubsection{MIMO Struggles:}\label{mimo-struggles}

\textbf{Line-of-sight channels} (rank-deficient H matrix)\\
\textbf{High mobility} (channel changes faster than CSI update)\\
\textbf{Low SNR} (spatial multiplexing requires moderate SNR)\\
\textbf{Small form factors} (antenna spacing \textless{}
\$\textbackslash lambda\$/2 \$\textbackslash rightarrow\$ correlation)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{\texorpdfstring{ Further
Reading}{ Further Reading}}\label{further-reading}

\subsubsection{Textbooks}\label{textbooks}

\begin{itemize}
\tightlist
\item
  \textbf{Tse \& Viswanath}, \emph{Fundamentals of Wireless
  Communication} - Rigorous treatment of MIMO capacity
\item
  \textbf{Paulraj, Nabar, Gore}, \emph{Introduction to Space-Time
  Wireless Communications} - Comprehensive MIMO theory
\item
  \textbf{Cho et al.}, \emph{MIMO-OFDM Wireless Communications with
  MATLAB} - Practical implementation
\end{itemize}

\subsubsection{Key Papers}\label{key-papers}

\begin{itemize}
\tightlist
\item
  \textbf{Foschini \& Gans} (1998): ``On Limits of Wireless
  Communications\textbackslash ldots\{\}'' - Spatial multiplexing
  foundation
\item
  \textbf{Telatar} (1999): ``Capacity of Multi-antenna Gaussian
  Channels'' - MIMO capacity theory
\item
  \textbf{Alamouti} (1998): ``A Simple Transmit Diversity Technique'' -
  Space-time block codes
\end{itemize}

\subsubsection{Standards}\label{standards}

\begin{itemize}
\tightlist
\item
  \textbf{IEEE 802.11n/ac/ax}: WiFi MIMO specifications
\item
  \textbf{3GPP TS 36.211/38.211}: LTE/5G physical layer (MIMO details)
\item
  \textbf{3GPP TR 38.802}: 5G massive MIMO study
\end{itemize}

\subsubsection{Related Topics}\label{related-topics}

\begin{itemize}
\tightlist
\item
  {[}{[}OFDM-\&-Multicarrier-Modulation{]}{]} - MIMO-OFDM combination
\item
  {[}{[}Beamforming (coming soon){]}{]} - Advanced spatial processing
\item
  {[}{[}Channel-Equalization{]}{]} - MIMO detection algorithms
\item
  {[}{[}Real-World-System-Examples{]}{]} - LTE, 5G, WiFi implementations
\item
  {[}{[}Adaptive-Modulation-\&-Coding-(AMC){]}{]} - Per-stream
  adaptation
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Summary}: MIMO transforms wireless communications by exploiting
spatial dimension. Multiple antennas create a matrix channel with
multiple eigenmodes-\/-\/-each eigenmode can carry an independent data
stream. Spatial multiplexing delivers linear capacity scaling with
min(nT, nR), while diversity combining improves reliability. Beamforming
focuses energy and mitigates interference. Modern wireless (WiFi 6/7, 5G
NR) relies on MIMO for multi-gigabit rates and serves many users
simultaneously (MU-MIMO). Massive MIMO (64-256 antennas) in 5G base
stations achieves extraordinary spectral and energy efficiency through
favorable propagation and channel hardening. MIMO is not just an
improvement-\/-\/-it\textquotesingle s a paradigm shift.
