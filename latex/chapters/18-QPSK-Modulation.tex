% ==============================================================================
% CHAPTER 18: Quadrature Phase-Shift Keying (QPSK)
% ==============================================================================

\chapter{Quadrature Phase-Shift Keying (QPSK)}
\label{ch:qpsk}

\begin{nontechnical}
    \textbf{QPSK is like upgrading from two hand signals to four}, allowing you to send information twice as fast without shouting any louder.

    \parhead{The simple idea} Instead of just flipping a signal upside-down (like in BPSK), QPSK uses four distinct phase angles, typically at the 45$^\circ$ positions of a compass, to represent data:
    \begin{itemize}
        \item Bits "00" $\rightarrow$ Northeast (45$^\circ$)
        \item Bits "01" $\rightarrow$ Northwest (135$^\circ$)
        \item Bits "11" $\rightarrow$ Southwest (225$^\circ$)
        \item Bits "10" $\rightarrow$ Southeast (315$^\circ$)
    \end{itemize}
    By using four states instead of two, each signal "pulse" (or symbol) can carry two bits of information instead of just one.

    \parhead{Why it's the workhorse} QPSK hits a perfect sweet spot. It doubles the data rate of BPSK but is almost as robust against noise because the four signal positions are still maximally separated (90$^\circ$ apart). This blend of efficiency and reliability is why QPSK is a cornerstone of modern communications, used in everything from satellite TV and 4G/5G cellular networks to GPS signals.
\end{nontechnical}


\section{Overview and Properties}

\subsection{Overview}

\keyterm{Quadrature Phase-Shift Keying (QPSK)} is a digital modulation technique that encodes two bits of information per symbol by shifting the phase of a carrier wave to one of four possible states. These four states are typically separated by 90$^\circ$, providing a robust and spectrally efficient method of data transmission.

\begin{keyconcept}
    QPSK can be understood as two independent BPSK channels operating in parallel on orthogonal carriers (a cosine and a sine wave). This allows QPSK to achieve \textbf{double the spectral efficiency} of BPSK while maintaining the \textbf{same bit error rate performance} for a given $E_b/N_0$. This powerful combination of bandwidth efficiency and power efficiency makes it one of the most widely used modulation schemes in digital communications.
\end{keyconcept}


\subsection{Mathematical Representation}

The QPSK signal is represented by a carrier whose phase is one of four values, typically $\{45^\circ, 135^\circ, 225^\circ, 315^\circ\}$. In the complex baseband, this corresponds to four points on the IQ plane. The passband signal is generated by modulating the I and Q components with orthogonal carriers:
\begin{equation}
    s(t) = I(t) \cos(2\pi f_c t) - Q(t) \sin(2\pi f_c t)
\end{equation}
For a given symbol representing two bits, the baseband signals $(I(t), Q(t))$ take one of four constant values, for example, $(+1/\sqrt{2}, +1/\sqrt{2})$ for the bits "00". The use of \keyterm{Gray coding} ensures that any adjacent symbol error on the constellation results in only a single bit error, minimizing the final BER.


\subsection{Performance Characteristics}

\paragraph{Bit Error Rate (BER)}
The theoretical BER for coherent QPSK in an AWGN channel is identical to that of BPSK:
\begin{equation}
    \text{BER} = Q\left(\sqrt{\frac{2E_b}{N_0}}\right)
\end{equation}
This remarkable result means that we can double the data rate for a given bandwidth without any penalty in required power. To achieve a BER of $10^{-5}$, QPSK requires an $E_b/N_0$ of approximately 9.6 dB.

\paragraph{Spectral Efficiency}
Since QPSK transmits two bits per symbol, its spectral efficiency is double that of BPSK. After accounting for practical pulse shaping (with a roll-off factor $\alpha$):
\begin{equation}
    \eta = \frac{R_b}{B} = \frac{2}{1+\alpha} \quad (\text{bps/Hz})
\end{equation}
For a typical $\alpha=0.35$, the spectral efficiency is approximately 1.48 bps/Hz.


\subsection{Implementation}

\paragraph{Modulation}
A QPSK modulator first splits the incoming bitstream into two parallel streams (the I and Q channels). Each stream is then used to generate a bipolar signal (e.g., $\pm1$) which modulates one of the two orthogonal carriers ($\cos(\omega_c t)$ for I, and $-\sin(\omega_c t)$ for Q). The two resulting signals are then summed to create the final QPSK passband signal.

\paragraph{Demodulation}
Coherent demodulation requires a receiver with a local oscillator that is phase-locked to the incoming carrier. The received signal is mixed with both in-phase and quadrature local oscillators to separate the I and Q components. These are then low-pass filtered and sent to slicers to recover the binary data. The complexity of this carrier recovery circuit (often a \keyterm{Costas Loop}) is the main challenge of QPSK implementation.


\subsection{QPSK Variants}

\begin{description}
    \item[Offset QPSK (OQPSK)] In standard QPSK, it is possible for the signal to pass through the origin (a 180$^\circ$ phase jump), which causes large amplitude fluctuations that are problematic for power amplifiers. OQPSK mitigates this by delaying the Q channel by half a symbol period, ensuring that only 90$^\circ$ phase transitions can occur.
    \item[$\pi/4$-QPSK] This variant rotates the constellation by 45$^\circ$ every other symbol. This also avoids transitions through the origin and has the added benefit of making clock recovery easier for the receiver. It was widely used in 2G cellular systems like TDMA.
    \item[Differential QPSK (DQPSK)] Encodes information in the phase \emph{transitions} between symbols, not their absolute phase. This allows for much simpler non-coherent receivers but incurs a performance penalty of approximately 2-3 dB.
\end{description}


\begin{workedexample}{Wireless Microphone System Design}
    \parhead{Problem} Design a digital wireless microphone link for high-quality audio operating over 50 meters in the 2.4 GHz ISM band. The available RF bandwidth is 500 kHz.
    
    \parhead{System Requirements}
    \begin{itemize}
        \item Audio Quality: 32 kHz sampling, 12-bit quantization for broadcast-quality voice.
        \item Reliability: Target post-FEC BER of $10^{-6}$.
        \item Range: \qty{50}{m} line-of-sight.
    \end{itemize}
    
    \parhead{Design Process}
    \begin{derivationsteps}
        \step Calculate the raw bit rate.
        \[ R_b = (\text{Sample Rate}) \times (\text{Bits/Sample}) = 32,000 \times 12 = \qty{384}{kbps} \]
        \step Add overhead for forward error correction. A rate-1/2 code is common for robust links, doubling the transmitted bit rate.
        \[ R_{\text{coded}} = 384 \text{ kbps} \times 2 = \qty{768}{kbps} \]
        \step Choose a modulation and calculate the required bandwidth. For QPSK (2 bits/symbol) with a tight pulse-shaping filter ($\alpha=0.25$):
        \[ R_s = R_{\text{coded}} / 2 = \qty{384}{ksps} \]
        \[ B_{\text{req}} = R_s (1 + \alpha) = 384 \times 1.25 = \qty{480}{kHz} \]
        This fits within the available 500 kHz bandwidth.
        
        \step Perform a link budget analysis. Assume Tx power of 10 dBm, 2 dBi antennas, and a receiver noise figure of 6 dB.
        \begin{itemize}
            \item FSPL at 50m, 2.4 GHz: $\approx$ \qty{74.5}{dB}.
            \item Received Power ($P_r$): $10 + 2 + 2 - 74.5 = \qty{-60.5}{dBm}$.
            \item Noise Floor ($P_n$): $-174 + 10\log_{10}(480 \times 10^3) + 6 \approx \qty{-111.2}{dBm}$.
            \item Received SNR: $P_r - P_n = -60.5 - (-111.2) = \qty{50.7}{dB}$.
            \item Available $E_b/N_0$: $\text{SNR} - 10\log_{10}(R_b/B) \approx 50.7 - 10\log_{10}(384/480) \approx \qty{51.7}{dB}$.
        \end{itemize}
        
        \step Calculate the link margin. For a BER of $10^{-6}$, QPSK requires a theoretical $E_b/N_0$ of 10.5 dB. The rate-1/2 FEC provides a coding gain of about 5 dB.
        \[ \text{Required } E_b/N_0 = 10.5 \text{ dB (uncoded)} - 5.0 \text{ dB (coding gain)} \approx \qty{5.5}{dB} \]
        \[ \text{Link Margin} = (\text{Available}) - (\text{Required}) = 51.7 - 5.5 = \qty{46.2}{dB} \]
    \end{derivationsteps}
    
    \parhead{Interpretation} The link closes with a massive margin of over 46 dB. This is essential for a wireless microphone system, as it provides the robustness needed to overcome severe multipath fading (20-30 dB), body blocking (5-10 dB), and interference from nearby WiFi devices, ensuring a dropout-free performance.
\end{workedexample}


\begin{importantbox}[title={Further Reading}]
    QPSK is a foundational modulation scheme that serves as the basis for many more advanced concepts.
    \begin{description}
        \item[Higher-Order PSK & QAM] (\Cref{ch:8psk}, \Cref{ch:qam}) explore how the QPSK constellation can be extended to 8, 16, or more points to achieve higher spectral efficiencies.
        \item[Carrier Recovery] (\Cref{ch:sync}) provides a detailed analysis of the Costas Loop and other PLL-based circuits that are essential for coherent QPSK demodulation.
        \item[OFDM] (\Cref{ch:ofdm}) explains how thousands of low-rate QPSK signals can be transmitted in parallel to create a single high-speed, multipath-resistant link, as used in WiFi and 5G.
    \end{description}
\end{importantbox}
