% ==============================================================================
% CHAPTER 41: Synchronisation
% ==============================================================================

\chapter{Synchronisation}
\label{ch:synchronisation}

\begin{nontechnical}
    \textbf{Synchronisation is the complex, invisible dance that allows a receiver to tune into a transmitter's signal perfectly.} Before any data can be decoded, the receiver must precisely match the transmitter's frequency, phase, and timing.

    \parhead{The orchestra analogy}
    Imagine an orchestra. For the music to sound right, several things must be perfectly synchronised:
    \begin{itemize}
        \item \textbf{Frequency Sync:} All instruments must be tuned to the same reference pitch (e.g., A = 440 Hz). If not, the sound is dissonant.
        \item \textbf{Phase Sync:} All musicians in a section must play in step with the conductor's beat.
        \item \textbf{Timing/Frame Sync:} Everyone must know where beat "one" of the first bar is, so they all start the piece together.
    \end{itemize}
    A radio receiver must solve all these problems in milliseconds to decode a signal.

    \parhead{The consequences of failure}
    \begin{itemize}
        \item A slight \textbf{frequency offset} causes the constellation to spin, making decoding impossible.
        \item A \textbf{phase error} rotates the constellation, causing symbol errors.
        \item A \textbf{timing error} means the receiver samples the signal between symbols, where the data is just noise.
    \end{itemize}
    Your phone or WiFi router dedicates a significant amount of processing power and uses special "preamble" signals purely for the purpose of achieving and maintaining this synchronisation.
\end{nontechnical}


\subsection{Overview}

\keyterm{Synchronisation} is the process by which a receiver aligns its internal reference clocks and oscillators to the timing and phase of an incoming signal. It is a prerequisite for all forms of coherent demodulation and is one of the most challenging aspects of practical receiver design.

\begin{keyconcept}
    A complete communication system requires four distinct levels of synchronisation to function:
    \begin{enumerate}
        \item \textbf{Carrier Frequency Synchronisation:} Matching the local oscillator frequency to the incoming carrier.
        \item \textbf{Carrier Phase Synchronisation:} Aligning the local oscillator's phase to the carrier's phase.
        \item \textbf{Symbol Timing Synchronisation:} Determining the precise instants at which to sample the incoming waveform.
        \item \textbf{Frame Synchronisation:} Identifying the start and end boundaries of data packets or frames.
    \end{enumerate}
    Failure at any of these levels results in a complete loss of communication.
\end{keyconcept}


\subsection{Carrier Synchronisation (Frequency and Phase)}

\parhead{The Problem}
Independent oscillators at the transmitter and receiver will never have the exact same frequency and phase. This difference, known as \keyterm{Carrier Frequency Offset (CFO)} and phase offset, must be estimated and corrected. A residual CFO causes the received constellation diagram to rotate continuously, while a phase offset causes a static rotation. Higher-order modulation schemes like 256-QAM are extremely sensitive to these errors, tolerating less than a degree of phase error.

\parhead{The Solution: Phase-Locked Loops (PLLs)}
Carrier synchronisation is typically achieved using a \keyterm{Phase-Locked Loop (PLL)}. A PLL is a feedback control system that continuously adjusts the frequency and phase of a local oscillator to match the incoming signal.
\begin{itemize}
    \item \textbf{Acquisition:} The initial, coarse process of locking onto the carrier frequency. This is often aided by preambles or known synchronisation sequences.
    \item \textbf{Tracking:} The continuous, fine-tuning process of tracking small phase and frequency drifts during data reception.
\end{itemize}
For suppressed-carrier modulations like BPSK and QPSK, a specialised PLL called a \keyterm{Costas Loop} is used, which can recover the carrier even in the absence of a pilot tone. Modern systems often use fully digital, decision-directed loops that use the decoded data itself to refine the phase and frequency estimates.


\subsection{Symbol Timing Synchronisation}

\parhead{The Problem}
The receiver must know the precise moments in time to sample the incoming waveform to capture each symbol at its point of maximum energy and minimum intersymbol interference. A timing offset causes the receiver to sample on the "transition" between symbols, leading to a dramatic loss in SNR.

\parhead{The Solution: Timing Recovery Algorithms}
Timing recovery circuits are designed to find the optimal sampling instant.
\begin{itemize}
    \item \textbf{Early-Late Gate Synchroniser:} A classic technique that takes three samples per symbol—"early," "on-time," and "late"—and adjusts the clock until the energy in the early and late samples is equal.
    \item \textbf{Gardner Algorithm:} A highly efficient, non-data-aided algorithm that uses just two samples per symbol to generate a timing error signal. It is widely used in modern digital receivers for its simplicity and excellent performance.
\end{itemize}


\subsection{Frame Synchronisation}

\parhead{The Problem}
Once the receiver is locked onto the carrier and symbol timing, it receives a continuous stream of symbols. It still needs to know where each packet or "frame" of data begins and ends.

\parhead{The Solution: Preamble Detection}
Frame synchronisation is achieved by prefixing each packet with a known, unique bit sequence called a \keyterm{preamble} or \keyterm{synchronisation word}. The receiver continuously correlates the incoming data stream with this known pattern. When the correlation output exceeds a certain threshold, the receiver declares that a frame has been detected and begins decoding the subsequent payload. The design of these preambles (e.g., using Barker or Zadoff-Chu sequences) is optimised to have excellent autocorrelation properties, allowing for robust detection even in very noisy conditions.


\begin{workedexample}{Synchronisation in WiFi (802.11a/g)}
    \parhead{Problem} Analyse the preamble structure of a WiFi packet and its role in synchronisation.
    \parhead{The 802.11a/g Preamble}
    Every WiFi packet begins with a 16 $\mu$s physical layer preamble, divided into two parts.
    \begin{description}
        \item[Short Training Field (8 $\mu$s)] Consists of 10 repetitions of a short, known symbol. Its purpose is signal detection, automatic gain control (AGC) settling, and \textbf{coarse frequency offset estimation}. The repetitive nature allows for a simple auto-correlation algorithm at the receiver.
        \item[Long Training Field (8 $\mu$s)] Consists of 2 repetitions of a longer, known symbol, preceded by a cyclic prefix. Its purpose is \textbf{fine frequency offset estimation} and, critically, \textbf{channel estimation} for the OFDM equaliser.
    \end{description}
    \parhead{Interpretation} In just 16 microseconds, the WiFi receiver is able to detect the packet, adjust its amplifier gain, correct a frequency offset of up to $\pm$800 kHz, estimate the multipath channel response for all 52 subcarriers, and achieve fine timing synchronisation. This rapid and robust synchronisation process is what enables reliable, high-speed packet-based communication in the complex indoor environment.
\end{workedexample}


\begin{importantbox}[title={Further Reading}]
    Synchronisation is a vast and essential field that underpins the practical implementation of every concept in this book.
    \begin{description}
        \item[OFDM] (\Cref{ch:ofdm}) is particularly sensitive to frequency synchronisation errors, which can destroy the orthogonality between subcarriers, leading to Inter-Carrier Interference (ICI).
        \item[Modulation Schemes] (\Cref{ch:qam}, \Cref{ch:8psk}) discusses the increasing sensitivity of higher-order modulation schemes to phase synchronisation errors (phase noise).
        \item[Channel Equalisation] (\Cref{ch:equalisation}) is the process that follows synchronisation. The equaliser can only function correctly if it is fed a signal that has been properly synchronised in time and frequency.
    \end{description}
\end{importantbox}